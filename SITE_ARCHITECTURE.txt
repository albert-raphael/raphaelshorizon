# ğŸ—ï¸ Raphael's Horizon - Complete Site Architecture Documentation

## Overview
Raphael's Horizon is a comprehensive Christian literature and audio platform built with a modern full-stack architecture featuring user authentication, content management, and admin capabilities.

---

## ğŸ“ BACKEND STRUCTURE (Node.js/Express API)

### Core Files:
```
backend/
â”œâ”€â”€ server.js              # Main Express server entry point
â”œâ”€â”€ package.json           # Dependencies & scripts
â”œâ”€â”€ .env                   # Environment variables (DB, secrets, etc.)
â”œâ”€â”€ oauth20.json           # Google OAuth credentials
â””â”€â”€ create-admin.js        # Script to create admin user
```

### Configuration:
```
backend/config/
â”œâ”€â”€ database.js            # MongoDB connection setup
â””â”€â”€ passport.js            # Google OAuth strategy
```

### Data Models (MongoDB):
```
backend/models/
â”œâ”€â”€ User.js                # User accounts, roles, auth
â”œâ”€â”€ Post.js                # Blog posts
â”œâ”€â”€ Comment.js             # Comments on posts
â”œâ”€â”€ Media.js               # File uploads
â””â”€â”€ Analytics.js           # Site analytics data
```

### Business Logic:
```
backend/controllers/
â”œâ”€â”€ authController.js      # Login, register, Google OAuth
â”œâ”€â”€ blogController.js      # Blog post CRUD operations
â”œâ”€â”€ commentController.js   # Comment management
â”œâ”€â”€ uploadController.js    # File upload handling
â””â”€â”€ analyticsController.js # Analytics processing
```

### API Routes:
```
backend/routes/
â”œâ”€â”€ auth.js                # Authentication endpoints
â”œâ”€â”€ blog.js                # Blog post routes
â”œâ”€â”€ comments.js            # Comment routes
â”œâ”€â”€ books.js               # Book-related routes
â”œâ”€â”€ upload.js              # File upload routes
â”œâ”€â”€ users.js               # User management
â”œâ”€â”€ analytics.js           # Analytics routes
â”œâ”€â”€ subscriptions.js       # Subscription handling
â””â”€â”€ admin.js               # Admin-only routes
```

### Middleware:
```
backend/middleware/
â”œâ”€â”€ auth.js                # JWT authentication middleware
â”œâ”€â”€ error.js               # Error handling middleware
â””â”€â”€ validation.js          # Input validation middleware
```

### Utilities:
```
backend/utils/
â”œâ”€â”€ sendEmail.js           # Email sending functionality
â””â”€â”€ cronJobs.js            # Scheduled tasks
```

---

## ğŸ¨ FRONTEND STRUCTURE (HTML/CSS/JavaScript)

### Core Files:
```
frontend/
â”œâ”€â”€ index.html             # Main homepage
â”œâ”€â”€ 404.html               # Error page
â”œâ”€â”€ site-manifest.json     # PWA manifest
â”œâ”€â”€ sw.js                  # Service worker for PWA
â””â”€â”€ .dockerfile            # Docker configuration
```

### Assets:
```
frontend/assets/
â”œâ”€â”€ documents/             # Static documents
â”œâ”€â”€ images/                # Image files
â””â”€â”€ icons/                 # Icon files
```

### Styling:
```
frontend/css/
â”œâ”€â”€ styles.css             # Main stylesheet
â”œâ”€â”€ auth.css               # Authentication styles
â””â”€â”€ admin-login.css        # Admin login styles
```

### JavaScript:
```
frontend/js/
â”œâ”€â”€ scripts.js             # Main site functionality
â”œâ”€â”€ auth.js                # Authentication handling
â”œâ”€â”€ api.js                 # API communication
â”œâ”€â”€ cookies.js             # Cookie management
â”œâ”€â”€ pwa-install.js         # PWA installation
â””â”€â”€ pdfjs/                 # PDF viewing library
    â”œâ”€â”€ pdf.mjs
    â””â”€â”€ pdf.worker.mjs
```

### Pages Structure:
```
frontend/pages/
â”œâ”€â”€ about/                 # About pages
â”‚   â”œâ”€â”€ about-us.html
â”‚   â”œâ”€â”€ assimagbe-albert-raphael.html
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ admin/                 # Admin panel
â”‚   â”œâ”€â”€ login_admin.html   # Admin login page
â”‚   â”œâ”€â”€ admin-dashboard.html # Admin dashboard
â”‚   â”œâ”€â”€ admin-login.css/js # Admin styling/scripts
â”‚   â”œâ”€â”€ admin-security.js  # Security management
â”‚   â”œâ”€â”€ admin-analytics.js # Analytics management
â”‚   â”œâ”€â”€ admin-books.js     # Book management
â”‚   â”œâ”€â”€ admin-users.js     # User management
â”‚   â””â”€â”€ admin-audio.js     # Audio content management
â”œâ”€â”€ blog/                  # Blog section
â”‚   â”œâ”€â”€ index.html         # Blog listing
â”‚   â”œâ”€â”€ blog-template.html # Post template
â”‚   â”œâ”€â”€ categories.html    # Category pages
â”‚   â”œâ”€â”€ post-1.html        # Individual posts
â”‚   â””â”€â”€ blog-manager.js    # Blog management
â”œâ”€â”€ books/                 # Books section
â”‚   â”œâ”€â”€ books.html         # Books overview
â”‚   â”œâ”€â”€ audio-books/       # Audio books pages
â”‚   â””â”€â”€ books-reader/      # Book reader functionality
â”œâ”€â”€ contact/               # Contact pages
â””â”€â”€ profile/               # User profile pages
```

### Content Library:
```
frontend/library/
â”œâ”€â”€ books/                 # Book files and covers
â”‚   â”œâ”€â”€ books_cover/       # Book cover images
â”‚   â””â”€â”€ New folder/        # Additional book content
â”œâ”€â”€ audio/                 # Audio book files
â”‚   â””â”€â”€ covers/            # Audio book cover images
â”œâ”€â”€ audio_links and books Title.md  # Content metadata
â””â”€â”€ audio_links and books Title.txt # Content lists
```

---

## ğŸ”„ DATA FLOW & ARCHITECTURE

### Authentication Flow:
1. Frontend (auth.js) â†’ Login/Register forms
2. API Call â†’ POST /api/auth/login or /api/auth/register
3. Backend (authController.js) â†’ Validate credentials
4. Database (User.js) â†’ Store/retrieve user data
5. JWT Token â†’ Return to frontend for session management

### Content Management:
1. Admin Dashboard â†’ Content creation forms
2. API Calls â†’ POST /api/blog or /api/upload
3. Backend Controllers â†’ Process and validate data
4. Database Models â†’ Store in MongoDB
5. Frontend Display â†’ Render content dynamically

### File Upload Flow:
1. Frontend â†’ File selection and upload
2. API â†’ POST /api/upload
3. Backend (uploadController.js) â†’ Process file
4. Storage â†’ Save to server or cloud storage
5. Database â†’ Store file metadata

---

## ğŸ› ï¸ DEVELOPMENT SETUP

### Running the Application:

Backend Server:
```bash
cd backend
npm install
npm start  # Runs on port 5002
```

Frontend Server:
```bash
cd frontend
python -m http.server 3000  # Or use any static server
```

Database:
- MongoDB Atlas (configured in .env)
- Local MongoDB (optional)

### Key URLs:
- Main Site: http://localhost:3000
- API: http://localhost:5002/api
- Admin Login: http://localhost:3000/pages/admin/login_admin.html
- Admin Dashboard: http://localhost:3000/pages/admin/admin-dashboard.html

---

## ğŸ“Š CURRENT FEATURES

### User Features:
- âœ… Google OAuth login
- âœ… Email/password authentication
- âœ… User registration
- âœ… Session management
- âœ… Protected content access

### Content Features:
- âœ… Blog system with posts and comments
- âœ… Book library with PDF reader
- âœ… Audio book collection
- âœ… File upload system
- âœ… Search and categorization

### Admin Features:
- âœ… Admin authentication
- âœ… Dashboard with analytics
- âœ… Content management
- âœ… User management
- âœ… Security monitoring

### Technical Features:
- âœ… Progressive Web App (PWA)
- âœ… Responsive design
- âœ… RESTful API
- âœ… JWT authentication
- âœ… MongoDB database
- âœ… File upload handling

---

## ğŸš€ NEXT STEPS FOR DEVELOPMENT

1. Testing: Complete end-to-end testing of all features
2. Security: Implement HTTPS and additional security measures
3. Performance: Optimize images, implement caching
4. SEO: Add meta tags, sitemap, structured data
5. Analytics: Integrate Google Analytics or similar
6. Deployment: Set up production hosting (Vercel, Netlify, etc.)

---

## ğŸ” ADMIN CREDENTIALS

Default Admin Account:
- Email: admin@raphaelshorizon.com
- Password: admin123

---

## ğŸ“ API ENDPOINTS SUMMARY

### Authentication:
- POST /api/auth/register - User registration
- POST /api/auth/login - User login
- POST /api/auth/admin/login - Admin login
- GET /api/auth/google - Google OAuth
- GET /api/auth/logout - Logout

### Blog:
- GET /api/blog - Get all posts
- POST /api/blog - Create post (admin)
- GET /api/blog/:id - Get single post
- PUT /api/blog/:id - Update post (admin)
- DELETE /api/blog/:id - Delete post (admin)

### Comments:
- GET /api/comments/:postId - Get comments for post
- POST /api/comments - Create comment
- DELETE /api/comments/:id - Delete comment (admin)

### Upload:
- POST /api/upload - Upload file
- GET /api/upload/:filename - Get uploaded file

### Analytics:
- GET /api/analytics - Get site analytics
- POST /api/analytics - Record analytics event

---

## ğŸ—‚ï¸ FILE ORGANIZATION PRINCIPLES

1. **Separation of Concerns**: Backend handles data/API, Frontend handles UI
2. **Modular Architecture**: Each feature has its own controller/route/model
3. **Security First**: Authentication required for sensitive operations
4. **Scalable Structure**: Easy to add new features without major refactoring
5. **PWA Ready**: Service worker and manifest for offline functionality

---

## ğŸ› TROUBLESHOOTING

### Common Issues:
1. **"Failed to fetch" errors**: Check if backend server is running on port 5002
2. **MongoDB connection errors**: Verify .env MONGO_URI is correct
3. **Admin login fails**: Ensure admin user exists (run create-admin.js)
4. **CORS errors**: Backend should allow requests from localhost:3000

### Debug Commands:
```bash
# Check backend server
curl http://localhost:5002/api/health

# Check MongoDB connection
cd backend && node -e "require('./config/database')"

# Create admin user
cd backend && node create-admin.js
```

---

*Last Updated: January 2, 2026*
*Raphael's Horizon - Full-Stack Christian Literature Platform*</content>
<parameter name="filePath">d:\My Website\raphaelshorizon\SITE_ARCHITECTURE.md